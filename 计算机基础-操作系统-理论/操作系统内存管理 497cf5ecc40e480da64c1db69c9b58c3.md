# 操作系统内存管理

#操作系统的内存分配方式

## 基本概念:

### 拼凑算法:

- 将多块离散的内存拼凑起来,极浪费时间

### 碎片:

### 内部碎片:

- 一个资源被分配到一个较大的空间
- 此空间中剩余的内存大小被称为内部碎片
- 是一种被资源自身所浪费的空间

### 外部碎片:

- 留在系统中无法被利用起来的空间资源

## 连续空间分配方式:

- 从内存起始位置开始分配内存

### 连续的空间分配方式分为:

- 单一连续分配
- 固定空间分配
- 动态空间分配

### 各种分配方式的特点:

- 单一连续分配方式
- 固定空间分配方式:
    - 优点:多个作业可以同时工作
    - 缺点:会产生内部碎片
- 动态空间分配:
    - 包含四种分配内存的算法
        - 首次适应分配算法:
        - 循环首次适应算法:
        - 最佳适应算法
        - 最差适应算法:会产生更多的外部碎片

## 非连续空间分配方式:

### 页式管理

- 将内存空间分为一页一页的来存储

512B-8KB

- Windows系统中,一页大小默认4kb

会产生内部碎片:10kb的资源,要分配,需要3页=12kb空间存储

页号=逻辑地址/页大小

页内位移=逻辑地址%页大小

### 如何通过内存的逻辑地址寻找物理地址(通过页表)

### 何为页表:

- 存储页号与块号(物理内存快)的对应的一块内存
- 能够确定逻辑地址与实际地址间的关系
- 一般存储于进程中的页表寄存器
    - 每个进程中都包含一个页表寄存器
- 需要执行的进程的页表需要放在内存中,不需要执行的进程不在内存中

### 页表寄存器存储的要素:

- 页表始址
- 页表长度

### 逻辑地址找到物理地址:

- 假设一个进程的逻辑地址是A;
- 通过页大小(4kb)获取到页内位移=A%4kb
- 通过页大小(4kb)获取到页号=A/4kb
- 通过页表寄存器已知页表始址
- 物理地址=页表始址+页号×页大小+页内位移

### 段式管理:

- 进程要多少空间给多少空间
- 将内存拆成一块一块的,会产生外部碎片(方便了用户)

寻址

找到内容

### 段页式管理:

综合优点

一段中存储n页

- 段页式管理访问3次内存
    - 访问内存找到段的地址
- 页找到物理内存地址
- 

# 页面置换算法:

![https://www.notion.so../PH4/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86.assets/image-20201017150952590.png](https://www.notion.so../PH4/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86.assets/image-20201017150952590.png)

image-20201017150952590

4 2 1 3 5 4 3