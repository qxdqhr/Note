# 堆区栈区的区别

## 生命周期

- 栈区:
  - 仅在大括号内存在
- 堆区:
  - 到释放前都存在

## 申请方式:

- 栈区:
  - 系统自动分配
  - 系统自动回收
- 堆区:
  - 程序员申请(调用malloc,realloc,calloc)
  - 程序员回收
  - 未回收的会由系统回收,可能会引发内存泄漏

## 申请大小的限制:

- 栈区:
  - 有固定大小,超出会引发栈溢出错误
- 堆区:

## 系统响应方式:

- 堆区不是连续空间
  - 存在管理内存的链表;
  - 申请空间时,从链表中遍历选取一块大小合适的内存进行分配;
  - 释放内存时,将对应空间重新挂载回内存链表中
- 栈区是连续空间
  - 连续空间找到立即分配

## 申请效率:

- 栈区效率高于堆区
  - 栈由系统自动分配，速度快。但程序员是无法控制的
  - 堆区中有遍历链表过程

## 生长方向不同:

- 栈区分配空间是从高地址到低地址
  - 连续定义变量a,b,c后定义的变量地址总较低,数组同理
- 堆区分配空间是从低地址到高地址

## 存储的事物不同:

- 栈区:
  - 变量(除全局变量与静态变量)
  - 函数入口地址
  - 注意:
    - 本次函数调用结束后，局部变量先出栈，然后是参数，最后栈顶指针指向最开始存的地址，也就是主函数中的下一条指令，程序由该点继续执行。
- 堆区:	一般是在堆的头部用一个字节存放堆的大小。
  - 地址
  - 数据

## 是否会产生内存碎片:

- 堆区会产生
- 栈区不会产生

后续:https://blog.csdn.net/aaricyang/article/details/89632330

