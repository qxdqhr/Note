# 问题描述:

- 两个线程,分别对一全局变量a(初值为0)各自执行100次++操作,请判断A的最大最小值各为多少?

## 答案:

- 最大值:200
- 最小值:2

## 最小值求取流程:

- A,B两寄存器先读取a中的值
  - 剩余次数:(A:100次)(B:100次)
  - A:0		B:0		a:0
- A,B各执行1次++
  - 剩余次数:(A:99次)(B:99次)
  - A:1		B:1		a:0
- A先得到1次时间片,写回a,此时B未写回
  - 剩余次数:(A:99次)(B:99次)
  - 写回状态:(A:已写回)(B:未写回)
  - A:1		B:1		a:1
- A立刻读取此时a中的新值,并对其进行98次++,之后得到时间片,写回
  - 剩余次数:(A:1次)(B:99次)
  - 写回状态:(A:已写回)(B:未写回)
  - A:1+98		B:1		a:99
- 此时,B得到1个时间片,将B中的值向a中写回,发生覆盖,覆盖A刚写入的值99
  - 剩余次数:(A:1次)(B:99次)
  - 写回状态:(A:已写回)(B:已写回)
  - A:99		B:1		a:1
- A,B两寄存器再读取a中的值
  - 剩余次数:(A:1次)(B:99次)
  - 写回状态:(A:已写回)(B:已写回)
  - A:1		B:1		a:1
- B先进行99次++,A进行1次++,B直接写回
  - 剩余次数:(A:0次)(B:0次)
  - 写回状态:(A:未写回)(B:已写回)
  - A:1+1		B:1+99		a:100
- A将自身的值写回变量中
  - 剩余次数:(A:0次)(B:0次)
  - 写回状态:(A:已写回)(B:已写回)
  - A:2		B:100		a:2
- a的最终值为2;

## 问题根本原因:

- 已知线程在进行工作时,先将操作值写入自身寄存器中
- 操作完成后再将运算后的值从寄存器中写回