# 5.线程基础

线程（thread） 高并发程序开发，线程模型，体积更小，相对于进程更轻量 线程是进程的子单位 进程包含线程，线程是进程中分裂出的新的调度单位 进程创建时，内核要对进程资源 进行初始化和分配内存 线程分裂时会从进程中获取一部分资源独占 进程0-3G中最大的是堆区 每个线程在堆区挖去一段空间用以创建用户栈（用户栈不能共享，只能各自独占） Linux中，8M虚拟内存（线程栈地址） 还会与进程共享一部分资源空间（离婚后财产分开，但孩子是两个人共享的） 哪些资源是共享的，哪些资源是非共享资源 共享： 1）静态变量，全局变量， 2）静态库，动态库， 3）linux中堆默认共享堆空间，创建栈时 4）内核空间一定共享的，一个电脑就一个内核空间， 一个进程中只有一种PCB进程控制块 TCB：线程控制块 1进程中10线程中仅有一个PCB和10个TCB 线程异常（多种）导致线程终止 导致进程终止 5）默认文件描述符表是共享的 6）信号处理动作共享，进程捕捉到的信号。。。 非共享： 1）用户空间栈不共享（无论进程还是线程） 2）信号屏蔽字（线程进程信号集） 每个进程有两个信号集默认线程从进程继承，线程更改时，进程信号集不变 3）线程控制块非共享（TCB）

核的眼睛中认识的线程还是进程？ 只认调度单位（可为线程也可为进程） LWP（轻量级进程的缩写） 每个进程都有一个LWP的编号 内核只认识LWP编号 一个进程也有一个LWP编号 1进程中10线程中有11个LWP

有几个LWP接收到KEY时，LWP才工作 CPU的调度器分配KEY

进程可蜕化为线程 资源独占被称为进程，如果某个调度单位与进程共享资源， 那么进程蜕化为主控线程 被进程创建出来的线程被称为普通线程 1个主控线程，n个普通线程

如何区分：谁创建的线程（调用pThread），谁是主控线程 若此时进程都已经终止

API分为库函数和。。函数

线程原语 1.基本概述： 一系列线程相关的API ，用于用于开发多线程开发程序 进程都是系统提供的函数 线程函数都是第三方的（Ubuntu16.04采用的是NPTL线程库） 线程库与WIndows可能不同 不同平台选用不同线程库 原理差别不大 而windows和Linux进程xx差别较大 2.线程函数 pthread_create()线程创建 pthread——self（）线程ID获取函数 pthread——join（）线程回收函数

线程的两种状态 线程终止状态：默认JOIN（回收态）线程终止时，用户需要使用JOIN函数回收资源及回收码 DETACH（分离态）线程终止内核自动回收所有资源

线程属性： 如何修改线程属性 修改线程属性对多线程开发

线程

线程功能函数的错误处理