# 11.进程间通信

# 进程间通信

- 使用一个进程以修改其他进程中的变量的操作

### 进程间通信的几种方法

### 内核对象:

- 各个进程之间的用户空间是私有的,想要在进程间传输数据,需要在进程的共享区中进行操作
- 用户的内核空间是共享的
    - Windows下2G~4G
- 内核对象一般由句柄来控制

### 事件:

### 通信流程:

- 创建事件:
    
    ```
    HANDLE CreateEvent
    ```
    

### 消息

### 共享内存

- 全局堆区申请的空间 global_Alloc() eg：ctrl+c 在任意进程都可以粘贴到 4.套接字（网络间进程） 5.文件映射（读写大文件） 将磁盘上的文件映射到了。。。 只拷贝一次 提高了文件传输效率 6.管道 7.DLL：动态库进行进程间通信

其中通信效率最高的是：1，3基于内核模式下 1只能用于发通知 3 可以发送数据

看不到源代码 dll是库 如何将程序打包封装成库

库有哪些种类 Windows下的（封装在exe文件中，一般看不见） 库 静态库：在链接阶段将代码完整的拷贝到可执行程序中 动态库（DLL文件）：在链接阶段将代码中的引入库拷贝到可执行程序中

实现一个简单的类功能

静态库不是一个可执行程序 只能附加到某个程序中运行只能生成不能运行

测试静态库

将刚刚的lib 在链接期起作用 导入库

c++使用

已导入库但还是有错误

编译期中出错

导入库之后还要导入头文件

路径为当前目录

此时可以使用可执行程序

导入的静态库

重新生成新的exe为可以使用的软件

链接期出错 有声明无实现

extern “C”

使此函数以C语言方式编译

C语言一函数名寻找函数 （不支持函数重载）

附加依赖项 将库配置到自己的代码上

动态库：

会生成dll 静态库的代码外界可以直接用 动态库中外部仅能使用有导出符号的函数

会生成lib和dll 动态库中的lib叫做动态库的引用库 lib函数名和函数在dll中的位置（类似于一个索引表）

将文件替换，将头文件拷贝来

动态库的引入库

程序不含有动态库文件无法单独运行

将动态库和exe放在一起 即可运行

使用动态库的时候使用类定义一个对象 连接器错误 找不到构造和析构函数

导出一个类

库升级：函数中添加了一些东西 重新生成库 只改变了库 打补丁 软件的升级（替换掉原来的动态库文件）1.01-》》1.02

如果改动过大：添加了新接口 客户端更新 1.0->>2.0重新下载

显示运行时加载

加载库 Loadlibrary（文件名） windows。h 文件名可以是DLL也可以是EXE 返回值为一个句柄

获取函数地址 getProcAddress（） 返回值为i个函数指针

卸载库 饮食加载生命周期贯穿整个软件

导出库的方式 动态共享库

引用计数

DLL为进程间通信的一种方式

STL不支持DLL进程传递 自己写就可以消除警告 但警告不会影响程序的运行