# 网络层

IP协议:IP数据报结构 1. Internet网络层的主要内容 1. 路由协议:用于选择路由路径 1. RIP协议,OSPF协议,BGP协议 2. 转发表:用于存储路由计算所得的的路径信息 1. 转发表被网络层的协议(IP协议)在处理数据分组时使用 3. IP协议 1. IP地址的寻址方式 2. 所处理数据包的格式 3. 如何分组处理数据 4. ICMP协议:互联网控制 1. 网络层处理数据时出错的处理方法,生成有关差错报告 2. 路由器和主机之间进行一些信令信息的传输 3. 是伴随着IP协议一同运行的协议,实现IP协议同时也要实现ICMP协议 2. IP协议的数据报的结构:首部+数据段 1. 首部 1. 固定字段:20字节 1. 版本号: - 占用4比特(位); - 指明IP协议的版本; - 表示使用IPv4协议时,此值为4; - 表示使用IPv6协议时,此值为6; 2. 首部长度: - 占用4比特(位); - 指明IP协议中首部数据段的长度; - 其中四字节表示一个单位长度,首部长度值表示此IP协议数据报中有几个单位长度; - 即首部长度值范围是(0-15);可表明大数据段大小为(0-15*4)字节; 3.服务类型(TOS): - 占用8比特(位); - 指明网络传输过程中期望获得何种类型的服务; - 只有在网络环境提供区分服务时使用(区分服务:DiffServ); - 一般情况下不使用,IPv4网络不提供网络区分服务,通常此字段的取值为0(00H); 4.标识(用于IP分片) - 占用大小16位; - 用于表示有几个IP分组 - 和…..共同决定唯一一个IP分组 5.标志位(用于IP分片) - 占用3位 - 用于确定路由器是否可以对此IP分组进行分片; - 保留位 - DF位 - 指明是否禁止路由器对此IP分组进行分片 - = 1 :表示禁止分片 - = 0 :表示允许分片 - MF位 - 指明此IP分组是否是某一大IP分组经分片后形成的小分组; - = 1 :表明此分组并不是最后一片小分组 - = 0 :为某一大分组的最后一片分片(或此IP分组并未分片) 6.片偏移(用于IP分片) - 占用13位; - 指明一个IP分组的分片所存储数据是原IP地址的相对哪一部分数据的相对偏移量 - 分组未被分片则此值为0 7.生存时间(TTL) - IP分组在网络中可以通过的路由器数(跳步数) - IP分组创建时位TTL设定一个初值,IP分组每被路由器转发一次,TTL减1 - 当TTL=0时,路由器丢弃该IP分组;丢弃后会向发送此IP分组的主机发送一个ICMP协议的报文 1.
2. 可变部分:大小可为零 2. 数据段

最大传输单元MTU:链路层的数据帧 可以封装数据的上限 大IP分组向较小MTU链路转发时,数据可以被路由器分组(可能分也可能不分) IP分片达到目的主机后再将各个分片进行重组; 分组时:路由器分组 重组时:目的主机重组 IP分组中相关字段决定是否表示分片以及确定分片的表示顺序

若有一个分片在传输时丢失,目的主机会稍加等待,若未收到就将整个IP分组丢弃; 总长度,标识,标志位,片偏移

# 路由算法:

转发表是由路由算法确定 将一个网络抽象成为一个图 图G=(节点N,边E) 节点n=路由器集合