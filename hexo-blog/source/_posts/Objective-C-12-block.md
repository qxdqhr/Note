# block 是什么?

- block是1个数据类型 所以我们可以声明1个block类型的变量
- block类型的变量中专门存储1段代码
  - 这段代码可以有参数 可以有返回值
-  block也可作为函数的参数 和返回值
  - block 做参数见下文
  - 当block作为函数的返回值时,返回值的类型就必须要使用typedef定义的短类型

# block 中能存储什么样的代码?

- block变量中存储的代码是有限制的:
  - 声明block变量时,需要指定这个block变量存储的代码段是否有参数/返回值
  - 声明后,此block变量中就只能存储这样的代码

# 如何声明block变量?

- 返回值类型 (^block变量的名称)(参数列表);

~~~
void (^myBlock1)(); 表示声明了1个block类型的变量叫做myBlock1 这个变量中只能存储没有返回值没有参数的代码段.
int (^myBlock2)(); 
int (^myBlock3)(int num1,int num2);
~~~

# 如何初始化block变量?

- 写1个符合block要求的代码段.存储到block变量中就可以了.

~~~
block变量的名称 = ^返回值类型(参数列表){
 		代码段;
};
~~~

- 完整的 block初始化如下:

~~~objc
//无参无返回值的block
void (^myBlock1)(); //声明 block
myBlock1 = ^void(){ //block 初始化
  NSLog(@"我爱你");
  NSLog(@"我恨你");
};
//无参有返回值的block
int (^myBlock2)() = ^int(){
  int num1 = 10 + 20;
  return num1;
};
//有参有返回值的block
 int (^myBlock3)(int num1,int num2) = ^int(int num1,int num2){
  int num3= num1 + num2;
  return num3;
};
~~~

# 注意:

- 赋值给block变量的代码段必须要符合block变量的要求. 否则就会报错.

# 如何执行存储在block变量中的代码段?

- 语法: 

~~~
block变量名();
~~~

# 如何简写一个block?

- 完整版声明初始化见上述

## 返回值为void 的场合

- 若初始化 block 的代码段无返回值.那么代码段的void可省
  - 声明block中的参数返回值均不可省略

~~~objc
void (^myBlock1)() = ^(){
  NSLog(@"我爱你");
  NSLog(@"我恨你");
};
~~~

## 没有参数 的场合

- 若代码段没有参数,那么代码段的括号可省

 ~~~objc
 int (^myBlock2)() = ^int{
   int num1 = 10 + 20;
   return num1;
 };
 ~~~

## 没有参数和返回值 的场合   

- 当1个代码段既没有参数,也没有返回值时就只写^

 ~~~objc
 void (^myBlock1)() = ^{
   NSLog(@"我爱你");
   NSLog(@"我恨你");
 };
 ~~~

## 同时声明初始化 block ,且有参数的场合

- 声明处可以只写参数的类型而省略参数名

 ~~~~objc
 int (^myBlock3)(int,int) = ^int(int num1,int num2){
    int num3= num1 + num2;
    return num3;
 };
 ~~~~

## 初始化 block 的场合的返回值 

- 无论代码段是否有返回值.初始化 block时,可以不写返回值类型
  - 系统会自动的确定返回值的类型
- 如果代码段中没有返回任何数据 那么它会认为这个代码段是没有返回值的
- 如果代码中有返回数据 返回的数据是什么类型 它就会认为这个代码段是什么类型的

 # 如何简化block变量的复杂定义?

- 使用typedef关键字
  - 将1个长类型定义为1个短类型
  - 将长的block类型 定义为1个短类型
- 语法: 
  - typedef 返回值类型 (^新类型)(参数列表);

~~~objc
typedef void (^NewType)(); //代表重新定义了1个类型叫做NewType 是1个block类型 无参数无返回值的block类型
~~~

# 在block块中如何访问外部变量?

- 在block代码块的内部可以访问
  - 定义在外部的变量的值,
  - 定义在外部的局部变量和全局变量.
- 在block代码块的内部可以修改全局变量的值
  - 但是不能修改定义在外部的局部变量的值.

- 如果你希望我们定义的局部变量可以允许在block代码的内部去修改,那么就为这个局部变量加1个__block的修饰符

# 如何为函数定义block类型的参数?

- 就是在小括弧中声明1个指定格式的block变量就可以了
- 可以使用typedef简化定义,这样看起来就不会晕了.

# 如何调用带block参数的函数?

- 在调用时传入符合形参block要求的代码段
  - 可以将代码段存储到1个block变量中,然后传递这个block变量
  - 也可以直接将符合要求的代码段写在小括弧中传递

- 通过Xcode提示可以快速的生产block代码段的框架.

# block 作为参数的实际效果是怎样的?

- 将调用者自己写的1段代码 传递到 函数的内部去执行
- 当方法的内部需要执行1个功能.但是这个功能具体的实现函数的内部不确定

# block与函数的区别?

   ## 相同点: 

- 都是封装1段代码

## 不同点:

### 本质:

- block是1个数据类型
- 函数是1个函数

### 是否是变量

- 我们可以声明block类型的变量 函数就只是函数. 

### 作为参数

- block可以作为函数的参数. 而函数不能直接作为函数的参数.